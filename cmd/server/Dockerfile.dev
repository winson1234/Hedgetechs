# Development Dockerfile for Go backend with hot-reloading
FROM golang:1.23-alpine

# Install git (required for some Go packages) and Air for hot-reloading
# Pin Air to v1.52.3 for compatibility with Go 1.23
RUN apk add --no-cache git && \
    go install github.com/air-verse/air@v1.52.3

# Set working directory
WORKDIR /app

# Copy go mod files and download dependencies
# This layer will be cached unless go.mod or go.sum changes
COPY go.mod go.sum ./
RUN go mod download

# Source code will be mounted as a volume for hot-reloading
# No need to COPY source code here

# Expose port
EXPOSE 8080

# Run Air for hot-reloading
CMD ["air"]
