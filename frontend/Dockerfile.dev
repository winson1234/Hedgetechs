# ============================================
# Development Dockerfile with Hot Reload
# ============================================
FROM node:20-alpine

# Install bash for better shell support
RUN apk add --no-cache bash

# Enable pnpm
RUN corepack enable && corepack prepare pnpm@latest --activate

WORKDIR /app

# Copy package files
COPY package.json pnpm-lock.yaml ./

# Install dependencies (cached if package.json unchanged)
RUN pnpm install --frozen-lockfile

# Expose Vite dev server port
EXPOSE 5173

# Health check
HEALTHCHECK --interval=10s --timeout=5s --start-period=10s --retries=3 \
    CMD curl -f http://localhost:5173 || exit 1

# Start Vite dev server (binds to 0.0.0.0 for Docker)
CMD ["pnpm", "dev", "--host", "0.0.0.0"]